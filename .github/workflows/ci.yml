# Nome do Workflow de Integração Contínua
name: CI Pipeline

# Gatilho (Trigger)
# Este workflow será acionado em pull requests para a branch 'develop'
on:
  pull_request:
    branches: [ develop ]

# Trabalhos (Jobs)
# Define uma sequência de tarefas a serem executadas
jobs:
  build-and-test:
    # O tipo de máquina virtual para executar o job
    runs-on: ubuntu-latest

    # Passos (Steps)
    # Sequência de tarefas que serão executadas como parte do job
    steps:
      # 1. Checkout do código
      # Baixa uma cópia do seu repositório para a máquina virtual
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2. Configurar o ambiente Node.js
      # Instala a versão especificada do Node.js
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm' # Configura o cache para o npm para acelerar as instalações futuras

      # 3. Instalar as dependências do projeto
      # 'npm ci' é usado em vez de 'npm install' para instalações mais rápidas e consistentes em ambientes de CI
      - name: Install dependencies
        run: npm ci

      # 4. Executar o Linter
      # Verifica se o código segue as boas práticas e padrões de estilo
      - name: Run ESLint
        run: npm run lint

      # 5. Executar o Build de Produção
      # O comando 'next build' compila a aplicação e automaticamente verifica erros de TypeScript
      - name: Run build
        run: npm run build

      # 6. Executar os Testes Unitários
      # Verifica a lógica dos componentes e funções isoladamente
      - name: Run tests
        run: npm test
